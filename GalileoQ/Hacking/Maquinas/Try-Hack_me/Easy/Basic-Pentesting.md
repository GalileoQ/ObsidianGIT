#Linux #Easy 
Hacemos el reconocimiento de nmap:
![[Pasted image 20240612135832.png]]
Vamos a ver el puerto 80 y hacemos fuzzing para descubrir directorios de esta web:
![[Pasted image 20240612135837.png]]
Y nos encontramos con un directorio llamado development, por lo que accedemos a él:
![[Pasted image 20240612135842.png]]

![[Pasted image 20240612135847.png]]
Y dentro del fichero dev.txt se habla de una versión 2.5.12 de apache que se está utilizando:
![[Pasted image 20240612135851.png]]
Y si buscamos en searchsploit vemos que existen vulnerabilidades para esta versión y además nos dice algo de strust, al igual que en el fichero dev.txt:
![[Pasted image 20240612135904.png]]
Pero si probamos estos dos exploits vemos que no funciona:
![[Pasted image 20240612135911.png]]
Pero también vimos que teníamos abierto el puerto 445, por lo que podemos usar enum4linux para enumerar usuarios samba, con el comando enum4linux -a y vemos que nos encuentra dos usuarios:
![[Pasted image 20240612135916.png]]
Aunque otra forma de encontrar estos usuarios hubiera sido enumerando con un script de nmap el puerto 445, donde veremos que tenemos habilitado el acceso como el usuario anonymous utilizando el comando nmap --script smb-enum* 10.10.40.216. Pero ahora vamos a continuar con el ataque de fuerza bruta con hydra,  por el puerto 22 con estos usuarios; y por ejemplo probamos con el usuario jan y vemos que nos encuentra su contraseña:
```bash
hydra 10.10.40.216 ssh -l jan -P rockyou.txt
```
Y lo encuentra:
![[Pasted image 20240612135923.png]]
Por tanto ahora entramos via ssh:
![[Pasted image 20240612135927.png]]
Una vez dentro, nos ubicamos dentro de la carpeta personal del usuario kay pero vemos que no tenemos acceso a un fichero llamado pass.bak:
![[Pasted image 20240612135932.png]]
Por tanto ahora vamos a ejecutar el linux exploit suggester para encontrar formas de elevar nuestros privilegios, por lo que lo compartimos desde la máquina atacante con un servidor web de python:
![[Pasted image 20240612135938.png]]
Y nos encuentra el pwnkit:
![[Pasted image 20240612135942.png]]
Y vemos que seguramente sea compatible porque estamos ante un ubuntu 16.04:
![[Pasted image 20240612135946.png]]
Vamos a este repositorio tras hacer una búsqueda de esta vulnerabilidad pública en google:
![[Pasted image 20240612135951.png]]
Lo descargamos y lo compartimos con la máquina víctima, pero primero comprimiéndolo para poder pasar todos los archivos con el comando zip -r escalada.zip y un asterisco:
![[Pasted image 20240612135955.png]]
Ahora podemos compartir este fichero comprimido con la máquina víctima y descomprimirlo ahí:
![[Pasted image 20240612140000.png]]
Pero en la máquina víctima vemos que no podemos utilizar unzip porque no está instalado, por lo que probamos con el comando jar xf y vemos que sí funciona:
![[Pasted image 20240612140004.png]]
Pero si compilamos vemos que no nos funciona porque tampoco tiene make o gcc instalado en el sistema::
![[Pasted image 20240612140011.png]]
Ya que vemos que de esta manera no hay forma de entrar, podemos investigar el id_rsa del usuario kay, al cual sí tenemos acceso:
![[Pasted image 20240612140016.png]]
Por lo que nos descargamos este id_rsa y lo usamos para iniciar sesión vía ssh con este usuario; y para ello podemos usar scp, por lo que primero en nuestra máquina atacante habilitamos el servicio ssh:
![[Pasted image 20240612140022.png]]
Y desde la máquina víctima nos compartimos el id_rsa:
![[Pasted image 20240612140043.png]]
Pero si lo usamos para conectarnos vemos que no funciona porque nos pide una contraseña para poder desencriptar este id_rsa:
![[Pasted image 20240612140046.png]]
Ahora cogemos el id_rsa y con ssh2john lo pasamos a un fichero password.txt:
![[Pasted image 20240612140050.png]]
Una vez aquí, crackeamos con john the ripper este código y ya tenemos la contraseña para utilizar el id_rsa, la cual es beeswax:
![[Pasted image 20240612140054.png]]
Ahora nos conectamos por ssh y ya funciona bien y estamos dentro:

Y obtenemos la última flag:
![[Pasted image 20240612140119.png]]

