Las funciones de gestión de usuarios de este laboratorio se basan en un punto final GraphQL. Este punto final acepta solicitudes con un tipo de contenido de `x-www-form-urlencoded`y por lo tanto es vulnerable a ataques de falsificación de solicitud entre sitios (CSRF).

Para resolver el laboratorio, cree un código HTML que utilice un ataque CSRF para cambiar la dirección de correo electrónico del espectador y luego cárguelo en su servidor de exploits.

Puede iniciar sesión en su propia cuenta utilizando las siguientes credenciales: `wiener:peter`.

Obtenga más información sobre cómo trabajar con GraphQL en Burp Suite.

iniciamos sesión en el laboratorio y vamos a intentar hacer un cambio de contraseña. debemos interceptar esta solicitud y ver como se comporta por detras.
![[Pasted image 20250826105938.png]]

parece que la solicitud de cambio de contraseña se envía correctamente. aquí lo que me llama la atención son las 2 cookies que nos muestras la solicitud. enviemos esto al repeater
![[Pasted image 20250826110111.png]]

si modificamos el correo de nuevo podemos ver que las cookie se mantienen pero el correo si ha cambiado. por lo que podemos reutilizar estas cookie
![[Pasted image 20250826110257.png]]

ahora si cambiamos el `Content-Type: application/json` por `Content-Type: x-www-form-urlencoded` y enviamos la solicitud podemos ver que nos indica que la query no esta presente.
![[Pasted image 20250826111024.png]]